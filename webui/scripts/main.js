"use strict";angular.module("edmApp",["ngMaterial","ngAnimate","ui.router","pascalprecht.translate","ui.ace"]),angular.module("edmApp").config(["$mdThemingProvider","$locationProvider","$urlRouterProvider","$stateProvider","$translateProvider",function(e,t,r,n,a){a.useStaticFilesLoader({prefix:"locales/",suffix:".json"}),a.useSanitizeValueStrategy("escape"),a.determinePreferredLanguage(),a.fallbackLanguage("en-EN"),r.otherwise("/"),t.html5Mode({enabled:!0,requireBase:!0}),n.state("app",{controllerAs:"app",url:"/",controller:"AppController",templateUrl:"views/app.html"})}]),angular.module("edmApp").directive("fileDropper",["$parse",function(e){return{restrict:"A",transclude:!0,template:['<div class="dropper-overlay" translate>DROP_YOUR_FILE_HERE</div>',"<div ng-transclude></div>"],link:function(t,r,n){var a=new Dragster(r[0]),o=e(n.fileDropper);r.bind("dragover",function(e){return e.stopPropagation(),e.preventDefault(),!1}),r.bind("dragster:enter",function(e){return e.stopPropagation(),e.preventDefault(),angular.element(this).children().eq(0).addClass("active"),!1}),r.bind("dragster:leave",function(e){return e.stopPropagation(),e.preventDefault(),angular.element(this).children().eq(0).removeClass("active"),!1}),r.bind("drop",function(e){e.stopPropagation(),e.preventDefault(),a.dragleave(e);var r=new FileReader,n={name:e.dataTransfer.files[0].name,size:e.dataTransfer.files[0].size};return r.readAsText(e.dataTransfer.files[0]),r.onload=function(e){n.content=e.target.result,t.$apply(function(){o(t,{$file:n})})},!1})}}}]),angular.module("edmApp").directive("register",function(){function e(e,t,r){return Array(t-String(e).length+1).join(r||"0")+e}return{restrict:"E",transclude:!1,replace:!0,scope:{name:"=",value:"=",format:"="},template:['<div class="register">','<div ng-bind="vm.name"></div>','<div ng-bind="vm.convertedValue">aa</div>',"</div>"].join(""),bindToController:!0,controllerAs:"vm",controller:["$scope",function(t){var r=this;t.$watchGroup(["vm.format","vm.value"],function(){var t=arguments[0][0],n=arguments[0][1];switch(t){case"hex":r.convertedValue=e(n.toString(16),16).toUpperCase();break;case"bit":r.convertedValue=e((n>>>0).toString(2),64);break;default:r.convertedValue=e(n,19)}})}]}}),angular.module("edmApp").controller("AppController",["$scope","$log","$mdSidenav","$mdMedia","$mdDialog",function(e,t,r,n,a){function o(e,t){return Math.floor(Math.random()*(t-e))+e}var i=this;i.locs=0,i.editorContent="",i.filesize=0,i.filename="new_file.s",i.customFullscreen=n("xs")||n("sm"),i.toggleMenu=function(){r("left").toggle()},i.editorChanged=function(e){i.locs=e[1].env.document.getLength()},i.format="hex",i.openSettingsDialog=function(e){var r=(n("sm")||n("xs"))&&i.customFullscreen;a.show({controller:"SettingsDialogController",controllerAs:"vm",templateUrl:"views/settings-dialog.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:r}).then(function(e){t.log("Settings dialog resolved",e)},function(){t.log("Settings dialog rejected")})},i.onDropFile=function(e){i.editorContent=e.content,i.filename=e.name,i.filesize=e.size},i.registers=[],i.runAll=function(){var e=new jsedumips64.WebUi;e.init();var r=e.runProgram(i.editorContent);0!=r.length?t.error(r):(t.log(e.getRegisters()),t.log(e.getMemory()),t.log(e.getStatistics()))},e.$watch(function(){return n("xs")||n("sm")},function(t){e.customFullscreen=t===!0});for(var l=0;l<32;l++)i.registers.push({name:"R"+l,value:o(0,Number.MAX_SAFE_INTEGER)});for(var l=0;l<32;l++)i.registers.push({name:"F"+l,value:o(0,Number.MAX_SAFE_INTEGER)});i.registers.push({name:"LO",value:o(0,Number.MAX_SAFE_INTEGER)}),i.registers.push({name:"HI",value:o(0,Number.MAX_SAFE_INTEGER)})}]),angular.module("edmApp").controller("SettingsDialogController",["$mdDialog",function(e){var t=this;t.availableLanguages={"en-EN":"English","it-IT":"Italiano"},t.ok=function(){e.hide()},t.cancel=function(){e.cancel()}}]);