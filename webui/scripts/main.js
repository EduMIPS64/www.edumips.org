"use strict";angular.module("edmApp",["ngMaterial","ngAnimate","ui.router","pascalprecht.translate","ui.ace","angular-keyboard"]),angular.module("edmApp").config(["$mdThemingProvider","$locationProvider","$urlRouterProvider","$stateProvider","$translateProvider",function(e,t,n,r,o){o.useStaticFilesLoader({prefix:"locales/",suffix:".json"}),o.useSanitizeValueStrategy("escape"),o.determinePreferredLanguage(),o.fallbackLanguage("en-EN"),n.otherwise("/"),t.html5Mode({enabled:!0,requireBase:!0}),r.state("app",{controllerAs:"app",url:"/",controller:"AppController",templateUrl:"views/app.html"})}]),angular.module("edmApp").directive("fileDropper",["$parse",function(e){return{restrict:"A",transclude:!0,template:['<div class="dropper-overlay" translate>DROP_YOUR_FILE_HERE</div>',"<div ng-transclude></div>"],link:function(t,n,r){var o=new Dragster(n[0]),a=e(r.fileDropper);n.bind("dragover",function(e){return e.stopPropagation(),e.preventDefault(),!1}),n.bind("dragster:enter",function(e){return e.stopPropagation(),e.preventDefault(),angular.element(this).children().eq(0).addClass("active"),!1}),n.bind("dragster:leave",function(e){return e.stopPropagation(),e.preventDefault(),angular.element(this).children().eq(0).removeClass("active"),!1}),n.bind("drop",function(e){e.stopPropagation(),e.preventDefault(),o.dragleave(e);var n=new FileReader,r={name:e.dataTransfer.files[0].name,size:e.dataTransfer.files[0].size};return n.readAsText(e.dataTransfer.files[0]),n.onload=function(e){r.content=e.target.result,t.$apply(function(){a(t,{$file:r})})},!1})}}}]),angular.module("edmApp").directive("register",function(){function e(e,t,n){return Array(t-String(e).length+1).join(n||"0")+e}return{restrict:"E",transclude:!1,replace:!0,scope:{name:"=",value:"=",format:"="},template:['<div class="register">','<div ng-bind="vm.name"></div>','<div ng-bind="vm.convertedValue">aa</div>',"</div>"].join(""),bindToController:!0,controllerAs:"vm",controller:["$scope",function(t){var n=this;t.$watchGroup(["vm.format","vm.value"],function(){var t=arguments[0][0],r=arguments[0][1];switch(t){case"hex":n.convertedValue=e(r.toString(16),16).toUpperCase();break;case"bit":n.convertedValue=e((r>>>0).toString(2),64);break;default:n.convertedValue=e(r,19)}})}]}}),angular.module("edmApp").controller("AppController",["$scope","$log","$mdSidenav","$mdMedia","$mdDialog",function(e,t,n,r,o){function a(e,t){return Math.floor(Math.random()*(t-e))+e}var i=this;i.locs=0,i.editorContent="",i.filesize=0,i.filename="new_file.s",i.customFullscreen=r("xs")||r("sm"),i.toggleMenu=function(){n("left").toggle()},i.editorChanged=function(e){i.locs=e[1].env.document.getLength()},i.format="hex",i.openSettingsDialog=function(e){var n=(r("sm")||r("xs"))&&i.customFullscreen;o.show({controller:"SettingsDialogController",controllerAs:"vm",templateUrl:"views/settings-dialog.html",parent:angular.element(document.body),targetEvent:e,clickOutsideToClose:!0,fullscreen:n}).then(function(e){t.log("Settings dialog resolved",e)},function(){t.log("Settings dialog rejected")})},i.onDropFile=function(e){i.editorContent=e.content,i.filename=e.name,i.filesize=e.size},i.registers=[],i.runSingle=function(){t.log("Run single step invoked")},i.runMulti=function(){t.log("Run multi-cycle invoked")},i.stop=function(){t.log("Stop invoked")},i.runAll=function(){t.log("Run invoked"),t.log(i.editorContent);var e=new jsedumips64.WebUi;e.init();var n=e.runProgram(i.editorContent);0!=n.length?t.error(n):(t.log(e.getRegisters()),t.log(e.getMemory()),t.log(e.getStatistics()))},e.$watch(function(){return r("xs")||r("sm")},function(t){e.customFullscreen=t===!0});for(var l=0;l<32;l++)i.registers.push({name:"R"+l,value:a(0,Number.MAX_SAFE_INTEGER)});for(var l=0;l<32;l++)i.registers.push({name:"F"+l,value:a(0,Number.MAX_SAFE_INTEGER)});i.registers.push({name:"LO",value:a(0,Number.MAX_SAFE_INTEGER)}),i.registers.push({name:"HI",value:a(0,Number.MAX_SAFE_INTEGER)})}]),angular.module("edmApp").controller("SettingsDialogController",["$mdDialog",function(e){var t=this;t.availableLanguages={"en-EN":"English","it-IT":"Italiano"},t.ok=function(){e.hide()},t.cancel=function(){e.cancel()}}]);